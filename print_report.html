
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=euc-kr" />
    <title>매출 / 매입 보고서</title>
    <link rel="stylesheet" href="/js/jquery-ui.min.css" type="text/css" />
    <link rel="stylesheet" href="/Css/A_common.css" type="text/css" />
    <script type="text/javascript" src="/js/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="/js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="/js/jq-yd-common.js"></script>
    <script type="text/javascript" src="/js/jquery-yessdata.js"></script>
    <script type="text/javascript">
        //<![CDATA[
        function computeNPurchaseDetailPrdListSum() {
            var frm = $("form[name='frmPurDet']");
            var sngCostPriceSum = 0.0, sngSellPriceSum = 0.0, ele = null;

            frm.find("input[name='prd_list_in_ysd_prd_won_total']").each(function (idx) {

                var sngCount = parseFloat(frm.find("input[name='prd_list_in_ysd_count']:eq(" + idx + ")").val().replace(/,/g, ""));
                var sngTmp = parseFloat(frm.find("input[name='prd_list_in_ysd_prd_won']:eq(" + idx + ")").val().replace(/,/g, ""));
                var sngTmp_sell_won_total = parseFloat(frm.find("input[name='prd_list_ysd_prd_won_total']:eq(" + idx + ")").val().replace(/,/g, ""));
                var ele = null;
                if (!isNaN(sngCount) && !isNaN(sngTmp)) {
                    frm.find("input[name='prd_list_in_ysd_prd_won']:eq(" + idx + ")").siblings("span").text(putComma(sngTmp + ""));
                    sngTmp *= sngCount;
                    sngSellPriceSum += sngTmp;
                    $(this).val(sngTmp);
                    $(this).siblings("span").text(putComma(sngTmp + ""));
                    /*원가율*/
                    //   if( sngTmp_sell_won_total > sngTmp){ //값이 맞지않을경우 제외
                    var w_rate = ((sngTmp / sngTmp_sell_won_total) * 100).toString();
                    w_rate = Number(w_rate);
                    w_rate = w_rate.toFixed(2);
                    frm.find("input[name='prd_list_in_ysd_prd_won_percent']:eq(" + idx + ")").siblings("span").text(w_rate + "");
                    // }
                } else {
                    $(this).val("");
                    $(this).siblings("span").text("");
                }

            });


            /*파트너 수수료*/
            if (frm.find("input[name='amount_psr']").length > 0) {
                var amount_psr = parseFloat(frm.find("input[name='amount_psr']").val().replace(/,/g, ""));
                var count_psr = parseFloat(frm.find("input[name='count_psr']").val().replace(/,/g, ""));
                var amount_contract = parseFloat(frm.find("input[name='amount_contract']").val().replace(/,/g, ""));
                var count_contract = parseFloat(frm.find("input[name='count_contract']").val().replace(/,/g, ""));
                var amount_psr2 = parseFloat(frm.find("input[name='amount_psr2']").val().replace(/,/g, ""));
                var count_psr2 = parseFloat(frm.find("input[name='count_psr2']").val().replace(/,/g, ""));

                frm.find("input[name='amount_psr']").siblings("span").text(putComma((amount_psr * count_psr) + ""));
                frm.find("input[name='amount_contract']").siblings("span").text(putComma((amount_contract * count_contract) + ""));
                frm.find("input[name='amount_psr2']").siblings("span").text(putComma((amount_psr2 * count_psr2) + ""));

                sngSellPriceSum += amount_psr + amount_contract + amount_psr2;  // 판매금액 공급가액

            }


            ele = $("#prd_list_in_sum_sell_price"); // 판매금액 공급가액
            if (ele.length > 0) {
                ele.html(putComma(Math.floor(sngSellPriceSum) + ""));
            }

            ele = $("#prd_list_in_sum_cost_price"); // 원가 공급가액
            if (ele.length > 0) {
                ele.html(putComma(Math.floor(sngCostPriceSum) + ""));
            }

            ele = $("#prd_list_in_sum_sell_price_vat"); // 판매금액 VAT

            if (ele.length > 0) {
                // 매출발주서 5247 번일때엔 부가가치세(285985)를 임의적용함. 나머지는 정상적으로 처리함
                if (frm.find("input[name='ys_code']").val() == "5247") {
                    ele.html(putComma(285985 + ""));
                } else {
                    ele.html(putComma(Math.floor(sngSellPriceSum * 0.1) + ""));
                }
            }

            if (ele.length > 0) {
                // 매출발주서 5247 번일때엔 부가가치세(285985)를 임의적용함. 나머지는 정상적으로 처리함
                if (frm.find("input[name='ys_code']").val() == "5247") {
                    ele.html(putComma(285985 + ""));
                } else {
                    ele.html(putComma(Math.floor(sngSellPriceSum * 0.1) + ""));
                }
            }
            ele = $("#prd_list_in_sum_cost_price_vat"); // 원가 VAT
            if (ele.length > 0) {
                ele.html(putComma(Math.floor(sngCostPriceSum * 0.1) + ""));
            }


            ele = $("#prd_list_in_sum_sell_price_add_vat"); // 판매금액 VAT포함금액
            if (ele.length > 0) {
                ele.html(putComma(Math.floor(sngSellPriceSum * 1.1) + ""));
            }

            ele = $("#prd_list_in_sum_cost_price_add_vat"); // 원가 VAT포함금액
            if (ele.length > 0) {
                ele.html(putComma(Math.floor(sngCostPriceSum * 1.1) + ""));
            }
            /*원가율*/
            var prd_list_sum_sell_price = $("#prd_list_sum_sell_price").html();  //판매가
            prd_list_sum_sell_price = parseInt(prd_list_sum_sell_price.replace(/,/g, ""));

            var prd_list_in_sum_cost_price_vat = $("#prd_list_in_sum_sell_price").html(); //원가
            prd_list_in_sum_cost_price_vat = parseInt(prd_list_in_sum_cost_price_vat.replace(/,/g, ""));

            //     if( prd_list_sum_sell_price > prd_list_in_sum_cost_price_vat){ //값이 맞지않을경우 제외
            var won_tot_rate = ((prd_list_in_sum_cost_price_vat / prd_list_sum_sell_price) * 100).toString();

            won_tot_rate = Number(won_tot_rate);
            won_tot_rate = won_tot_rate.toFixed(1);
            $("#prd_list_tot_won_percent").html(won_tot_rate); //원가율

            // }
            var prd_list_tot_won_margin = putComma(Math.floor(prd_list_sum_sell_price - prd_list_in_sum_cost_price_vat) + "");

            $("#prd_list_tot_won_margin").html(prd_list_tot_won_margin); //마진


        }

        $(function () {
            $(document).focus();

            // 매출제품 합계 계산
            computeNSaleDetailPrdListSum();
            // 매입제품 합계 계산
            computeNPurchaseDetailPrdListSum();

            $("#prd_list_sum_sell_price_tot").html($("#prd_list_sum_sell_price").html());

            $(".checkbox").click(function () {
                $('.checkbox:input[type=checkbox]').not(this).prop("checked", false);
            });


        });

        //]]>
    </script>
</head>
<body>
    <div class="prn_wrap">
        <div style="text-align:center; font-size:20px; font-weight:bold;">매출/매입 보고서</div>
        <span>
            <h4>일반사항</h4>
            <table class="print mb10">
                <colgroup>
                    <col width="100" />
                    <col width="250" />
                    <col width="100" />
                    <col width="250" />
                </colgroup>
                <tbody>
                    <tr>
                        <th class="ac">승인번호</th>
                        <td class="ac">160523003</td>
                        <th class="ac">수주구분</th>
                        <td class="ac">수의 / 상품</td>
                    </tr>
                    <tr>
                        <th class="ac">승인요청일 </th>
                        <td class="ac">2016-05-21</td>
                        <th class="ac">총 계약금액</th>
                        <td class="ac">1,700,000 (Vat 별도)</td>
                    </tr>
                    <tr>
                        <th class="ac">영업담당자</th>
                        <td class="ac">소프트웨어사업부 / 전종휘</td>
                        <th class="ac">결재조건</th>
                        <td class="ac">기타 / 30일</td>
                    </tr>
                    <tr>
                        <th class="ac">계산서 발행일</th>
                        <td class="ac">2016-06-01</td>
                        <th class="ac">수금예정일</th>
                        <td class="ac">2016-06-31</td>
                    </tr>
                </tbody>
            </table>
            <table class="print mb10">
                <colgroup>
                    <col width="100" />
                    <col width="134" />
                    <col width="100" />
                    <col width="133" />
                    <col width="100" />
                    <col width="133" />
                </colgroup>
                <tbody>
                    <tr>
                        <th colspan="6" scope="row">파트너 정보</th>
                    </tr>
                    <tr>
                        <th class="ac">파트너명</th>
                        <td class="ac">
                            해솔데이타[선입금]
                            <!-- [선입금] 파트너정보에 설정되어 있는 기본 결재 조건 -->
                        </td>
                        <th class="ac">부서명</th>
                        <td class="ac">영업팀</td>
                        <th class="ac">담당자</th>
                        <td class="ac">홍길동</td>
                    </tr>
                    <tr>
                        <th class="ac">전화</th>
                        <td class="ac">000-0000-0000</td>
                        <th class="ac">휴대폰</th>
                        <td class="ac">000-0000-0000</td>
                        <th class="ac">E-Mail</th>
                        <td class="ac">abc@abc.com</td>
                    </tr>
                </tbody>
            </table>
            <table class="print mb10">
                <colgroup>
                    <col width="100" />
                    <col width="134" />
                    <col width="100" />
                    <col width="133" />
                    <col width="100" />
                    <col width="133" />
                </colgroup>
                <tbody>
                    <tr>
                        <th colspan="6" scope="row">고객 정보</th>
                    </tr>
                    <tr>
                        <th class="ac">고객명</th>
                        <td class="ac">해솔데이타</td>
                        <th class="ac">부서명</th>
                        <td class="ac">영업팀</td>
                        <th class="ac">담당자</th>
                        <td class="ac">홍길동</td>
                    </tr>
                    <tr>
                        <th class="ac">전화</th>
                        <td class="ac">000-0000-0000</td>
                        <th class="ac">휴대폰</th>
                        <td class="ac">000-0000-0000</td>
                        <th class="ac">E-Mail</th>
                        <td class="ac">abc@abc.com</td>
                    </tr>
                </tbody>
            </table>
            <h4>매출사항</h4>
            <form name="frmPurDet">
                <table class="print mb10">
                    <colgroup>
                        <col width="150" />
                        <col width="" />
                    </colgroup>
                    <thead>
                        <tr>
                            <th scope="col">파트너</th>
                            <th scope="col">
                                <table class="inTable">
                                    <colgroup>
                                        <col style="" />
                                        <col style="width:10%;" />
                                        <col style="width:15%;" />
                                        <col style="width:15%;" />
                                    </colgroup>
                                    <tr>
                                        <td class="ac">매출품목</td>
                                        <td class="ac">수량</td>
                                        <td class="ac">단가</td>
                                        <td class="ac">매출금액</td>
                                    </tr>
                                </table>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th scope="row">한국유씨비제약(주)</th>
                            <td class="p0" scope="col">
                                <table class="inTable">
                                    <colgroup>
                                        <col style="" />
                                        <col style="width:10%;" />
                                        <col style="width:15%;" />
                                        <col style="width:15%;" />
                                    </colgroup>
                                    <tr>
                                        <td class="al">한컴오피스 한/글 방과후학교용 1년임대 Level A</td>
                                        <td class="ac">45</td>
                                        <td class="ar">105,000</td>
                                        <td class="ar br0">4,725,000</td>
                                    </tr>
                                    <tr>
                                        <td class="al">한컴오피스 한/글 방과후학교용 </td>
                                        <td class="ac">45</td>
                                        <td class="ar">105,000</td>
                                        <td class="ar br0">4,725,000</td>
                                    </tr>
                                    <tr>
                                        <td class="al">한컴오피스 한/글 방과후학교용 1년임대 Level B</td>
                                        <td class="ac">45</td>
                                        <td class="ar">105,000</td>
                                        <td class="ar br0">4,725,000</td>
                                    </tr>
                                    <tr>
                                        <td class="al">한컴오피스 한/글 방과후학교용 C</td>
                                        <td class="ac">45</td>
                                        <td class="ar">105,000</td>
                                        <td class="ar br0">4,725,000</td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <th scope="row">총매출합계</th>
                            <td class="ar">3,000(공급가액) + 300(Vat) = 3,300</td>
                        </tr>
                    </tbody>
                </table>

                <h4>매입사항</h4>
                <table class="print mb10">
                    <colgroup>
                        <col width="150" />
                        <col width="" />
                    </colgroup>
                    <thead>
                        <tr>
                            <th scope="col">메입처</th>
                            <th scope="col">
                                <table class="inTable">
                                    <colgroup>
                                        <col style="" />
                                        <col style="width:10%;" />
                                        <col style="width:10%;" />
                                        <col style="width:15%;" />
                                        <col style="width:15%;" />
                                    </colgroup>
                                    <tr>
                                        <td class="ac">매입품목</td>
                                        <td class="ac">마진율</td>
                                        <td class="ac">수량</td>
                                        <td class="ac">단가</td>
                                        <td class="ac">매입금액</td>
                                    </tr>
                                </table>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th scope="row">한글과컴퓨터</th>
                            <td class="p0" scope="col">
                                <table class="inTable">
                                    <colgroup>
                                        <col style="" />
                                        <col style="width:10%;" />
                                        <col style="width:10%;" />
                                        <col style="width:15%;" />
                                        <col style="width:15%;" />
                                    </colgroup>
                                    <tr>
                                        <td class="al">한컴오피스 한/글 방과후학교용 1년임대 Level A</td>
                                        <td class="ac">10%</td>
                                        <td class="ac">45</td>
                                        <td class="ar">105,000</td>
                                        <td class="ar br0">4,725,000</td>
                                    </tr>
                                    <tr>
                                        <td class="al">한컴오피스 한/글 방과후학교용 </td>
                                        <td class="ac">10%</td>
                                        <td class="ac">45</td>
                                        <td class="ar">105,000</td>
                                        <td class="ar br0">4,725,000</td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <th scope="row">마이크로소프트</th>
                            <td class="p0" scope="col">
                                <table class="inTable">
                                    <colgroup>
                                        <col style="" />
                                        <col style="width:10%;" />
                                        <col style="width:10%;" />
                                        <col style="width:15%;" />
                                        <col style="width:15%;" />
                                    </colgroup>
                                    <tr>
                                        <td class="al">한컴오피스 한/글 방과후학교용 1년임대 Level B</td>
                                        <td class="ac">10%</td>
                                        <td class="ac">45</td>
                                        <td class="ar">105,000</td>
                                        <td class="ar br0">4,725,000</td>
                                    </tr>
                                    <tr>
                                        <td class="al">한컴오피스 한/글 방과후학교용 C</td>
                                        <td class="ac">10%</td>
                                        <td class="ac">45</td>
                                        <td class="ar">105,000</td>
                                        <td class="ar br0">4,725,000</td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <th scope="row">총매입합계</th>
                            <td class="ar">3,000(공급가액) + 300(Vat) = 3,300</td>
                        </tr>
                    </tbody>
                </table>
                <!-- 수수료 지급사항은 조달건만 해당 -->
                <h4>수수료지급사항</h4>
                <table class="print mb10">
                    <colgroup>
                        <col style="width:150px;" />
                        <col style="width:;" />
                        <col style="width:150px;" />
                        <col style="width:150px;" />
                    </colgroup>
                    <thead>
                        <tr>
                            <th scope="col">수주구분</th>
                            <th scope="col">파트너명</th>
                            <th scope="col">수수료율</th>
                            <th scope="col">수수료금액</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th scope="row">PSR</th>
                            <td class="ac">해솔데이타</td>
                            <td class="ac">10%</td>
                            <td class="ar">4,725,000</td>
                        </tr>
                        <tr>
                            <th scope="row">수주</th>
                            <td class="ac">해솔데이타</td>
                            <td class="ac">10%</td>
                            <td class="ar">4,725,000</td>
                        </tr>
                        <tr>
                            <th scope="row">수주2</th>
                            <td class="ac">해솔데이타</td>
                            <td class="ac">10%</td>
                            <td class="ar">4,725,000</td>
                        </tr>
                        <tr>
                            <th scope="row">총수수료합계</th>
                            <td class="ar" colspan="3">3,000(공급가액) + 300(Vat) = 3,300</td>
                        </tr>
                    </tbody>
                </table>
                <!-- 수수료 지급사항 끝 -->
                <table class="print mb10" style="width: 350px;" align="right">
                    <colgroup>
                        <col width="50" />
                        <col width="110" />
                        <col width="60" />
                        <col width="140" />
                    </colgroup>
                    <tbody>
                        <tr>
                            <th scope="row">마진율</th>
                            <td class="ar"><span id="prd_list_tot_won_percent"></span>%</td>
                            <th scope="row">마진</th>
                            <td class="ar"><span id="prd_list_tot_won_margin"></span></td>
                        </tr>
                    </tbody>
                </table>
                <table class="print mb10">
                    <colgroup>
                        <col width="60" />
                        <col width="" />
                    </colgroup>
                    <tbody>
                        <tr>
                            <th scope="row">비고</th>
                            <td>계산서 발행후 익익월</td>
                        </tr>
                    </tbody>
                </table>


                <table class="print" style="width: 350px;" align="right">
                    <colgroup>
                        <col width="50" />
                        <col width="100" />
                        <col width="100" />
                        <col width="100" />
                        <col width="100" />
                    </colgroup>
                    <tbody>
                        <tr>
                            <td rowspan="2" class="ac">결<br />재</td>
                            <td class="ac">담 당</td>
                            <td class="ac">팀 장</td>
                            <td class="ac">영업관리부장</td>
                            <td class="ac">대표이사</td>
                        </tr>
                        <tr>
                            <td>&nbsp;</td>

                            <td height="25"></td>
                            <td></td>
                            <td></td>
                        </tr>
                    </tbody>
                </table>


            </form>
        </span>
    </div>
</body>
</html>
